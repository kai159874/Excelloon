<article class="layout mb-5">
  <div class="balloon-frame">
    <div class="card balloon balloon-<%= @balloon.color_status %>">
      <div id="favorite-btn-<%= @balloon.id %>">
        <%= render "public/favorites/favorite_btn", balloon: @balloon %>
      </div>
      <div class="balloon-content"><%= simple_format(h(@balloon.content)) %></div>
      <%= image_tag @balloon.convert_balloon_image("300"), class: "balloon-image" if @balloon.balloon_image.attached? %>
      <div>
        <%= render "public/balloon_stickers/balloon_sticker_btn", balloon: @balloon, stickers: @stickers %>
      </div>
    </div>
    <div class="d-flex justify-content-between">
      <div>
        <div class="balloon-created-time">投稿日時: <%= l @balloon.created_at %></div>
        <div class="balloon-user-id">ID: <%= @user.public_uid %></div>
      </div>
      <div class="report-btn">
        <%= link_to "報告", balloon_reports_path(@balloon), method: :post, data: { confirm: "このバルーンを不適切な内容として報告しますか？" }, class: "btn btn-sm btn-secondary" %>
      </div>
    </div>

    <% current_user.friends.each do |friend| %>
      <% if @balloon.user_id == friend.id %>
       <div><%= image_tag friend.get_profile_image, size: "60x60", class: "rounded-circle" %></div>
       <div><%= friend.name %></div>
      <% end %>
    <% end %>

    <% if @balloon.user_id === current_user.id %>
      <div class="balloon-delete">
        <%= link_to "削除", balloon_path(@balloon), method: :delete, class: "btn btn-danger border", local: true, data: { confirm: "バルーンを削除しますか？" } %>
      </div>

      <div>
        <%= form_with model: @balloon, method: :patch, local: true do |f| %>
          <div class="d-flex flex-column justify-content-center text-center">

            <%= render "public/balloons/color_select", f: f %>

            <div class="col-sm-7 col-md-4 mx-auto my-5">
              <%= f.submit "色変更", class: "btn btn-block btn-success" %>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <% if current_user == @user || current_user.friends.include?(@user) %>
    <table id="comments-<%= @balloon.id %>">
      <%= render "public/balloon_comments/comments", balloon: @balloon, user: @user %>
    </table>
    <div>
      <%= form_with model: [@balloon, @balloon_comment], local: false do |f| %>
      <%= f.text_area :comment, placeholder: "相互フォローのみコメントができます。" %>
      <%= f.submit "comment" %>
      <% end %>
    </div>
  <% else %>
    <p>---友達になることでコメントをすることができます。---</p>
  <% end %>

  <!--見た目調整-->

</article>


